package fr.cytech.integration

import org.apache.spark.sql.SparkSession
import org.scalatest.funsuite.AnyFunSuite

class MainSpec extends AnyFunSuite {
  val spark = SparkSession.builder()
    .master("local[1]")
    .appName("TaxiTest")
    .getOrCreate()

  import spark.implicits._

  test("Le filtre de nettoyage doit supprimer les trajets Ã  0 passager") {
    val data = Seq((1, 2.5), (0, 3.0)).toDF("passenger_count", "trip_distance")
    val cleaned = data.filter($"passenger_count" > 0)
    
    assert(cleaned.count() == 1)
  }
}